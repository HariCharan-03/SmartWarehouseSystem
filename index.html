<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Warehouse System | DAA Algorithms</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #0f0c29 0%, #302b63 50%, #24243e 100%);
            min-height: 100vh;
            color: #fff;
            padding: 20px;
            overflow-x: hidden;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 40px;
            animation: fadeInDown 0.8s ease;
        }

        h1 {
            font-size: 3rem;
            font-weight: 800;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }

        .subtitle {
            font-size: 1.2rem;
            color: #a0aec0;
            font-weight: 300;
        }

        .algo-highlight {
            display: inline-block;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            margin: 0 5px;
        }

        .card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 40px 0 rgba(102, 126, 234, 0.4);
        }

        .card-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 20px;
            color: #667eea;
        }

        .input-group {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        input[type="number"],
        input[type="text"] {
            flex: 1;
            min-width: 200px;
            padding: 15px 20px;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            color: #fff;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        input:focus {
            outline: none;
            border-color: #667eea;
            background: rgba(255, 255, 255, 0.15);
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.3);
        }

        input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        button {
            padding: 15px 35px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            border-radius: 12px;
            color: #fff;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 25px rgba(102, 126, 234, 0.6);
        }

        button:active {
            transform: translateY(0);
        }

        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .warehouses-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
        }

        .warehouse-card {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%);
            border: 2px solid rgba(102, 126, 234, 0.3);
            border-radius: 15px;
            padding: 20px;
            transition: all 0.3s ease;
        }

        .warehouse-card:hover {
            border-color: #667eea;
            box-shadow: 0 0 30px rgba(102, 126, 234, 0.4);
        }

        .warehouse-card.highlight {
            border-color: #66eaa4;
            box-shadow: 0 0 40px rgba(102, 234, 164, 0.6);
            animation: pulse 0.6s ease;
        }

        .warehouse-name {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 10px;
            color: #667eea;
        }

        .warehouse-companies {
            font-size: 0.9rem;
            color: #a0aec0;
            margin-bottom: 15px;
        }

        .racks-container {
            margin-top: 15px;
        }

        .rack {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 10px;
            transition: all 0.3s ease;
        }

        .rack.highlight {
            background: rgba(102, 234, 164, 0.2);
            border-color: #66eaa4;
            box-shadow: 0 0 20px rgba(102, 234, 164, 0.5);
        }

        .rack-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .rack-label {
            font-weight: 600;
            color: #667eea;
        }

        .rack-capacity {
            color: #a0aec0;
            font-size: 0.85rem;
        }

        .capacity-bar {
            width: 100%;
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            overflow: hidden;
        }

        .capacity-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            width: 0%;
            transition: width 0.5s ease;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        th,
        td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        th {
            background: rgba(102, 126, 234, 0.2);
            font-weight: 600;
            color: #667eea;
        }

        tr {
            transition: background 0.3s ease;
            opacity: 0;
            animation: fadeIn 0.5s ease forwards;
        }

        tr:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .animation-log {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 12px;
            padding: 20px;
            max-height: 500px;
            overflow-y: auto;
            margin-top: 20px;
        }

        .log-entry {
            padding: 12px;
            margin-bottom: 10px;
            background: rgba(102, 126, 234, 0.1);
            border-left: 4px solid #667eea;
            border-radius: 8px;
            animation: slideInRight 0.5s ease;
            display: flex;
            align-items: center;
            gap: 10px;
            flex-wrap: wrap;
        }

        .log-entry.success {
            background: rgba(102, 234, 164, 0.1);
            border-left-color: #66eaa4;
        }

        .daa-badge {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 700;
            letter-spacing: 1px;
            flex-shrink: 0;
        }

        .algo-badge {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.7rem;
            font-weight: 600;
            letter-spacing: 0.5px;
            flex-shrink: 0;
        }

        .graph-container {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
        }

        .graph-svg {
            width: 100%;
            height: 400px;
        }

        .graph-node {
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .graph-node:hover circle {
            fill: #667eea;
            r: 32;
        }

        .graph-edge {
            stroke: rgba(255, 255, 255, 0.3);
            stroke-width: 2;
        }

        .graph-edge.highlighted {
            stroke: #66eaa4;
            stroke-width: 4;
            animation: pathPulse 1s infinite;
        }

        .search-result {
            background: linear-gradient(135deg, rgba(102, 234, 164, 0.15) 0%, rgba(102, 126, 234, 0.15) 100%);
            border: 2px solid #66eaa4;
            border-radius: 15px;
            padding: 30px;
            margin-top: 20px;
            animation: fadeIn 0.5s ease;
        }

        .search-result.not-found {
            border-color: #ff6b6b;
            background: linear-gradient(135deg, rgba(255, 107, 107, 0.15) 0%, rgba(255, 107, 107, 0.1) 100%);
        }

        .result-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
        }

        .result-icon {
            font-size: 3rem;
        }

        .result-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #66eaa4;
        }

        .result-title.not-found {
            color: #ff6b6b;
        }

        .result-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .result-item {
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }

        .result-item:hover {
            background: rgba(255, 255, 255, 0.08);
            transform: translateY(-3px);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.3);
        }

        .result-label {
            color: #a0aec0;
            font-size: 0.85rem;
            font-weight: 500;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .result-value {
            color: #fff;
            font-size: 1.3rem;
            font-weight: 700;
        }

        .path-display {
            background: rgba(0, 0, 0, 0.3);
            padding: 20px;
            border-radius: 12px;
            margin-top: 15px;
        }

        .path-nodes {
            display: flex;
            align-items: center;
            gap: 10px;
            flex-wrap: wrap;
        }

        .path-node {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 10px 20px;
            border-radius: 10px;
            font-weight: 600;
        }

        .path-arrow {
            color: #66eaa4;
            font-size: 1.5rem;
        }

        .hidden {
            display: none;
        }

        .progress-bar {
            width: 100%;
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            overflow: hidden;
            margin-top: 20px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            width: 0%;
            transition: width 0.3s ease;
            box-shadow: 0 0 10px rgba(102, 126, 234, 0.8);
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(30px);
            }

            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        @keyframes pulse {

            0%,
            100% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.05);
            }
        }

        @keyframes pathPulse {

            0%,
            100% {
                stroke-opacity: 1;
            }

            50% {
                stroke-opacity: 0.5;
            }
        }

        ::-webkit-scrollbar {
            width: 10px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
        }
    </style>
</head>

<body>
    <div class="container">
        <header>
            <h1>üè≠ Smart Warehouse System</h1>
            <p class="subtitle">
                Powered by
                <span class="algo-highlight">Fractional Knapsack</span>
                &
                <span class="algo-highlight">Dijkstra's Algorithm</span>
            </p>
        </header>

        <!-- Warehouse Overview -->
        <div class="card">
            <h2 class="card-title">üì¶ Warehouse Overview</h2>
            <div class="warehouses-grid" id="warehousesGrid"></div>
        </div>

        <!-- Product Generation -->
        <div class="card">
            <h2 class="card-title">üé≤ Generate Products</h2>
            <div class="input-group">
                <input type="number" id="productCount" placeholder="How many products do you want?" min="1" max="50">
                <button id="generateBtn" onclick="generateProducts()">Generate Products</button>
            </div>
            <div id="progressContainer" class="hidden">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
            </div>
        </div>

        <!-- Products Table -->
        <div class="card hidden" id="productsCard">
            <h2 class="card-title">üìã Generated Products</h2>
            <table id="productsTable">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Product Name</th>
                        <th>Company</th>
                        <th>Weight (kg)</th>
                        <th>Value ($)</th>
                        <th>Value/Weight Ratio</th>
                    </tr>
                </thead>
                <tbody id="productsTableBody"></tbody>
            </table>
        </div>

        <!-- Arrangement Log -->
        <div class="card hidden" id="logCard">
            <h2 class="card-title">‚öôÔ∏è Fractional Knapsack Arrangement (Live)</h2>
            <div class="animation-log" id="animationLog"></div>
        </div>

        <!-- Search Feature -->
        <div class="card hidden" id="searchCard">
            <h2 class="card-title">üîç Search Product with Dijkstra's Algorithm</h2>
            <div class="input-group">
                <input type="text" id="searchInput" placeholder="Enter product name to search..."
                    list="productSuggestions">
                <datalist id="productSuggestions"></datalist>
                <button onclick="searchProduct()">Search Product</button>
            </div>
            <div id="searchResult"></div>
        </div>
    </div>

    <script>
        // Warehouse Configuration with Graph Structure
        const warehouses = [
            {
                name: 'Alpha Warehouse',
                companies: ['TechCorp', 'InnovateLabs'],
                id: 'alpha',
                racks: [
                    { id: 1, name: 'Small Capacity', capacity: 50, used: 0, products: [] },
                    { id: 2, name: 'Medium Capacity', capacity: 100, used: 0, products: [] },
                    { id: 3, name: 'Large Capacity', capacity: 200, used: 0, products: [] }
                ],
                graph: {
                    'Entrance': [{ node: 'NodeA', distance: 5 }, { node: 'NodeB', distance: 7 }],
                    'NodeA': [{ node: 'Entrance', distance: 5 }, { node: 'Rack1', distance: 3 }, { node: 'Rack2', distance: 4 }],
                    'NodeB': [{ node: 'Entrance', distance: 7 }, { node: 'Rack2', distance: 2 }, { node: 'Rack3', distance: 6 }],
                    'Rack1': [{ node: 'NodeA', distance: 3 }],
                    'Rack2': [{ node: 'NodeA', distance: 4 }, { node: 'NodeB', distance: 2 }],
                    'Rack3': [{ node: 'NodeB', distance: 6 }]
                }
            },
            {
                name: 'Beta Warehouse',
                companies: ['GlobalTrade', 'MegaRetail'],
                id: 'beta',
                racks: [
                    { id: 1, name: 'Small Capacity', capacity: 50, used: 0, products: [] },
                    { id: 2, name: 'Medium Capacity', capacity: 100, used: 0, products: [] },
                    { id: 3, name: 'Large Capacity', capacity: 200, used: 0, products: [] }
                ],
                graph: {
                    'Entrance': [{ node: 'NodeA', distance: 6 }, { node: 'NodeB', distance: 8 }],
                    'NodeA': [{ node: 'Entrance', distance: 6 }, { node: 'Rack1', distance: 4 }, { node: 'Rack2', distance: 5 }],
                    'NodeB': [{ node: 'Entrance', distance: 8 }, { node: 'Rack2', distance: 3 }, { node: 'Rack3', distance: 7 }],
                    'Rack1': [{ node: 'NodeA', distance: 4 }],
                    'Rack2': [{ node: 'NodeA', distance: 5 }, { node: 'NodeB', distance: 3 }],
                    'Rack3': [{ node: 'NodeB', distance: 7 }]
                }
            },
            {
                name: 'Gamma Warehouse',
                companies: ['SwiftLogistics', 'PrimeGoods'],
                id: 'gamma',
                racks: [
                    { id: 1, name: 'Small Capacity', capacity: 50, used: 0, products: [] },
                    { id: 2, name: 'Medium Capacity', capacity: 100, used: 0, products: [] },
                    { id: 3, name: 'Large Capacity', capacity: 200, used: 0, products: [] }
                ],
                graph: {
                    'Entrance': [{ node: 'NodeA', distance: 4 }, { node: 'NodeB', distance: 9 }],
                    'NodeA': [{ node: 'Entrance', distance: 4 }, { node: 'Rack1', distance: 2 }, { node: 'Rack2', distance: 6 }],
                    'NodeB': [{ node: 'Entrance', distance: 9 }, { node: 'Rack2', distance: 4 }, { node: 'Rack3', distance: 5 }],
                    'Rack1': [{ node: 'NodeA', distance: 2 }],
                    'Rack2': [{ node: 'NodeA', distance: 6 }, { node: 'NodeB', distance: 4 }],
                    'Rack3': [{ node: 'NodeB', distance: 5 }]
                }
            },
            {
                name: 'Delta Warehouse',
                companies: ['EliteSupply', 'NexusDistribution'],
                id: 'delta',
                racks: [
                    { id: 1, name: 'Small Capacity', capacity: 50, used: 0, products: [] },
                    { id: 2, name: 'Medium Capacity', capacity: 100, used: 0, products: [] },
                    { id: 3, name: 'Large Capacity', capacity: 200, used: 0, products: [] }
                ],
                graph: {
                    'Entrance': [{ node: 'NodeA', distance: 7 }, { node: 'NodeB', distance: 6 }],
                    'NodeA': [{ node: 'Entrance', distance: 7 }, { node: 'Rack1', distance: 5 }, { node: 'Rack2', distance: 3 }],
                    'NodeB': [{ node: 'Entrance', distance: 6 }, { node: 'Rack2', distance: 5 }, { node: 'Rack3', distance: 4 }],
                    'Rack1': [{ node: 'NodeA', distance: 5 }],
                    'Rack2': [{ node: 'NodeA', distance: 3 }, { node: 'NodeB', distance: 5 }],
                    'Rack3': [{ node: 'NodeB', distance: 4 }]
                }
            }
        ];

        const companies = warehouses.flatMap(w => w.companies);

        const productNames = [
            'Laptop', 'Smartphone', 'Tablet', 'Monitor', 'Keyboard',
            'Mouse', 'Headphones', 'Speaker', 'Camera', 'Printer',
            'Scanner', 'Router', 'Switch', 'Cable', 'Adapter',
            'Charger', 'Battery', 'Microphone', 'Webcam', 'Drive',
            'Memory Card', 'USB Hub', 'Docking Station', 'Stand',
            'Case', 'Screen Protector', 'Stylus', 'Controller',
            'Projector', 'Smartwatch', 'Fitness Tracker', 'Earbuds',
            'Power Bank', 'LED Light', 'Fan', 'Cooler', 'Desk Lamp',
            'Chair Mat', 'Cable Organizer', 'Phone Holder', 'Tripod',
            'Gimbal', 'Drone', 'Action Camera', 'Gaming Console',
            'VR Headset', 'Smart Speaker', 'Thermostat', 'Security Camera'
        ];

        let products = [];
        let usedProductNames = new Set();

        // Initialize Warehouses Display
        function initializeWarehouses() {
            const grid = document.getElementById('warehousesGrid');
            warehouses.forEach(warehouse => {
                const card = document.createElement('div');
                card.className = 'warehouse-card';
                card.id = `warehouse-${warehouse.id}`;

                let racksHTML = '';
                warehouse.racks.forEach(rack => {
                    racksHTML += `
                        <div class="rack" id="rack-${warehouse.id}-${rack.id}">
                            <div class="rack-header">
                                <span class="rack-label">Rack ${rack.id} - ${rack.name}</span>
                                <span class="rack-capacity" id="capacity-${warehouse.id}-${rack.id}">0/${rack.capacity} kg</span>
                            </div>
                            <div class="capacity-bar">
                                <div class="capacity-fill" id="fill-${warehouse.id}-${rack.id}"></div>
                            </div>
                        </div>
                    `;
                });

                card.innerHTML = `
                    <div class="warehouse-name">${warehouse.name}</div>
                    <div class="warehouse-companies">Companies: ${warehouse.companies.join(', ')}</div>
                    <div class="racks-container">
                        ${racksHTML}
                    </div>
                `;
                grid.appendChild(card);
            });
        }

        // Generate Random Product Name
        function getRandomProductName() {
            let availableNames = productNames.filter(name => !usedProductNames.has(name));

            if (availableNames.length === 0) {
                const baseName = productNames[Math.floor(Math.random() * productNames.length)];
                const suffix = Math.floor(Math.random() * 1000);
                return `${baseName}-${suffix}`;
            }

            const name = availableNames[Math.floor(Math.random() * availableNames.length)];
            usedProductNames.add(name);
            return name;
        }

        // Get Warehouse by Company
        function getWarehouseByCompany(company) {
            return warehouses.find(w => w.companies.includes(company));
        }

        // Add Log Entry
        function addLogEntry(message, isSuccess = false) {
            const log = document.getElementById('animationLog');
            const entry = document.createElement('div');
            entry.className = `log-entry ${isSuccess ? 'success' : ''}`;
            entry.innerHTML = message;
            log.appendChild(entry);
            log.scrollTop = log.scrollHeight;
        }

        // Highlight Warehouse and Rack
        function highlightRack(warehouseId, rackId) {
            document.querySelectorAll('.warehouse-card').forEach(card => {
                card.classList.remove('highlight');
            });
            document.querySelectorAll('.rack').forEach(rack => {
                rack.classList.remove('highlight');
            });

            const warehouseCard = document.getElementById(`warehouse-${warehouseId}`);
            const rackElement = document.getElementById(`rack-${warehouseId}-${rackId}`);

            if (warehouseCard) warehouseCard.classList.add('highlight');
            if (rackElement) rackElement.classList.add('highlight');

            setTimeout(() => {
                if (warehouseCard) warehouseCard.classList.remove('highlight');
                if (rackElement) rackElement.classList.remove('highlight');
            }, 1000);
        }

        // Update Rack Capacity Display
        function updateRackDisplay(warehouseId, rackId, used, capacity) {
            const capacityText = document.getElementById(`capacity-${warehouseId}-${rackId}`);
            const capacityFill = document.getElementById(`fill-${warehouseId}-${rackId}`);

            if (capacityText) capacityText.textContent = `${used.toFixed(2)}/${capacity} kg`;
            if (capacityFill) capacityFill.style.width = `${(used / capacity) * 100}%`;
        }

        // Sleep Function
        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        // Fractional Knapsack Algorithm
        async function fractionalKnapsack(warehouseProducts, warehouse) {
            // Sort by value/weight ratio (descending)
            warehouseProducts.sort((a, b) => b.valueWeightRatio - a.valueWeightRatio);

            addLogEntry(`<span class="daa-badge">DAA</span> <span class="algo-badge">Fractional Knapsack</span> <span>Sorting products by value/weight ratio for <strong>${warehouse.name}</strong></span>`);
            await sleep(500);

            for (let rack of warehouse.racks) {
                for (let product of warehouseProducts) {
                    if (product.placed) continue;

                    let remainingCapacity = rack.capacity - rack.used;

                    if (remainingCapacity <= 0) continue;

                    highlightRack(warehouse.id, rack.id);

                    if (product.weight <= remainingCapacity) {
                        // Place entire product
                        rack.products.push({ ...product, fraction: 1.0 });
                        rack.used += product.weight;
                        product.placed = true;
                        product.rack = rack.id;
                        product.fraction = 1.0;

                        updateRackDisplay(warehouse.id, rack.id, rack.used, rack.capacity);

                        addLogEntry(`<span class="daa-badge">DAA</span> <span>üì¶ Placed <strong>${product.name}</strong> (100%) in Rack ${rack.id} ‚Üí Capacity: ${rack.used.toFixed(2)}/${rack.capacity} kg</span>`);
                        await sleep(400);
                    } else {
                        // Fractional fill
                        let fraction = remainingCapacity / product.weight;
                        rack.products.push({ ...product, fraction });
                        rack.used = rack.capacity;
                        product.placed = true;
                        product.rack = rack.id;
                        product.fraction = fraction;

                        updateRackDisplay(warehouse.id, rack.id, rack.used, rack.capacity);

                        addLogEntry(`<span class="daa-badge">DAA</span> <span>üì¶ Placed <strong>${(fraction * 100).toFixed(1)}%</strong> of <strong>${product.name}</strong> in Rack ${rack.id} ‚Üí Capacity: FULL (${rack.capacity}/${rack.capacity} kg)</span>`);
                        await sleep(400);
                    }
                }
            }
        }

        // Dijkstra's Shortest Path Algorithm
        function dijkstra(graph, start, end) {
            const distances = {};
            const previous = {};
            const unvisited = new Set(Object.keys(graph));

            // Initialize
            for (let node of unvisited) {
                distances[node] = node === start ? 0 : Infinity;
                previous[node] = null;
            }

            while (unvisited.size > 0) {
                // Find node with minimum distance
                let current = null;
                let minDist = Infinity;
                for (let node of unvisited) {
                    if (distances[node] < minDist) {
                        minDist = distances[node];
                        current = node;
                    }
                }

                if (current === end) break;
                if (distances[current] === Infinity) break;

                unvisited.delete(current);

                // Update neighbors
                if (graph[current]) {
                    for (let neighbor of graph[current]) {
                        if (unvisited.has(neighbor.node)) {
                            let alt = distances[current] + neighbor.distance;
                            if (alt < distances[neighbor.node]) {
                                distances[neighbor.node] = alt;
                                previous[neighbor.node] = current;
                            }
                        }
                    }
                }
            }

            // Reconstruct path
            const path = [];
            let current = end;
            while (current) {
                path.unshift(current);
                current = previous[current];
            }

            return { path, distance: distances[end] };
        }

        // Generate Products
        async function generateProducts() {
            const count = parseInt(document.getElementById('productCount').value);

            if (!count || count < 1 || count > 50) {
                alert('Please enter a number between 1 and 50');
                return;
            }

            // Disable button
            const generateBtn = document.getElementById('generateBtn');
            generateBtn.disabled = true;
            generateBtn.textContent = 'Generating...';

            // Reset
            products = [];
            usedProductNames.clear();
            document.getElementById('productsTableBody').innerHTML = '';
            document.getElementById('animationLog').innerHTML = '';
            document.getElementById('searchResult').innerHTML = '';
            document.getElementById('productSuggestions').innerHTML = '';

            // Reset warehouses
            warehouses.forEach(warehouse => {
                warehouse.racks.forEach(rack => {
                    rack.used = 0;
                    rack.products = [];
                    updateRackDisplay(warehouse.id, rack.id, 0, rack.capacity);
                });
            });

            // Show cards
            document.getElementById('progressContainer').classList.remove('hidden');
            document.getElementById('productsCard').classList.remove('hidden');
            document.getElementById('logCard').classList.remove('hidden');
            document.getElementById('searchCard').classList.remove('hidden');

            addLogEntry(`<span class="daa-badge">DAA</span> <span>üöÄ Starting product generation for ${count} products...</span>`);
            await sleep(500);

            // Generate products
            for (let i = 0; i < count; i++) {
                const product = {
                    id: i + 1,
                    name: getRandomProductName(),
                    company: companies[Math.floor(Math.random() * companies.length)],
                    weight: parseFloat((Math.random() * 30 + 1).toFixed(2)),
                    value: Math.floor(Math.random() * 2000 + 100),
                    placed: false
                };

                product.valueWeightRatio = parseFloat((product.value / product.weight).toFixed(2));
                const warehouse = getWarehouseByCompany(product.company);
                product.warehouse = warehouse.name;
                product.warehouseId = warehouse.id;

                products.push(product);

                // Update progress
                const progress = ((i + 1) / count) * 100;
                document.getElementById('progressFill').style.width = progress + '%';

                // Add to table
                const tbody = document.getElementById('productsTableBody');
                const row = tbody.insertRow();
                row.style.animationDelay = `${i * 0.05}s`;
                row.innerHTML = `
                    <td>${product.id}</td>
                    <td><strong>${product.name}</strong></td>
                    <td>${product.company}</td>
                    <td>${product.weight} kg</td>
                    <td>$${product.value}</td>
                    <td><strong>${product.valueWeightRatio}</strong></td>
                `;

                // Add to datalist
                const datalist = document.getElementById('productSuggestions');
                const option = document.createElement('option');
                option.value = product.name;
                datalist.appendChild(option);
            }

            document.getElementById('progressContainer').classList.add('hidden');

            addLogEntry(`<span class="daa-badge">DAA</span> <span>‚úÖ Generated ${count} products successfully!</span>`, true);
            await sleep(800);

            // Apply Fractional Knapsack for each warehouse
            addLogEntry(`<span class="daa-badge">DAA</span> <span class="algo-badge">Fractional Knapsack</span> <span>üîÑ Starting optimal arrangement...</span>`);
            await sleep(500);

            for (let warehouse of warehouses) {
                const warehouseProducts = products.filter(p => p.warehouseId === warehouse.id);
                if (warehouseProducts.length > 0) {
                    await fractionalKnapsack(warehouseProducts, warehouse);
                }
            }

            addLogEntry(`<span class="daa-badge">DAA</span> <span>‚úÖ <strong>Fractional Knapsack arrangement complete!</strong> All products optimally placed.</span>`, true);

            // Re-enable button
            generateBtn.disabled = false;
            generateBtn.textContent = 'Generate Products';
        }

        // Search Product
        function searchProduct() {
            const searchTerm = document.getElementById('searchInput').value.trim();
            const resultDiv = document.getElementById('searchResult');

            if (!searchTerm) {
                alert('Please enter a product name');
                return;
            }

            const product = products.find(p =>
                p.name.toLowerCase() === searchTerm.toLowerCase()
            );

            if (!product) {
                resultDiv.innerHTML = `
                    <div class="search-result not-found">
                        <div class="result-header">
                            <div class="result-icon">‚ùå</div>
                            <div>
                                <div class="result-title not-found">Product Not Found</div>
                                <p style="color: #a0aec0; margin: 5px 0 0 0;">No product named "<strong>${searchTerm}</strong>" exists in the system.</p>
                            </div>
                        </div>
                    </div>
                `;
                return;
            }

            const warehouse = warehouses.find(w => w.id === product.warehouseId);
            const targetRack = `Rack${product.rack}`;

            // Run Dijkstra's Algorithm
            const { path, distance } = dijkstra(warehouse.graph, 'Entrance', targetRack);

            resultDiv.innerHTML = `
                <div class="search-result">
                    <div class="result-header">
                        <div class="result-icon">‚úÖ</div>
                        <div>
                            <div class="result-title">Product Located Successfully</div>
                            <p style="color: #a0aec0; margin: 5px 0 0 0;">Found: <strong>${product.name}</strong></p>
                        </div>
                    </div>
                    
                    <div class="result-grid">
                        <div class="result-item">
                            <div class="result-label">üè≠ Warehouse</div>
                            <div class="result-value">${product.warehouse}</div>
                        </div>
                        
                        <div class="result-item">
                            <div class="result-label">üì¶ Rack Number</div>
                            <div class="result-value">Rack ${product.rack}</div>
                        </div>
                        
                        <div class="result-item">
                            <div class="result-label">üè¢ Company</div>
                            <div class="result-value">${product.company}</div>
                        </div>
                        
                        <div class="result-item">
                            <div class="result-label">‚öñÔ∏è Weight</div>
                            <div class="result-value">${product.weight} kg</div>
                        </div>
                        
                        <div class="result-item">
                            <div class="result-label">üí∞ Value</div>
                            <div class="result-value">$${product.value}</div>
                        </div>

                        <div class="result-item">
                            <div class="result-label">üìä Placement</div>
                            <div class="result-value">${(product.fraction * 100).toFixed(1)}%</div>
                        </div>
                    </div>

                    <div class="path-display">
                        <div style="color: #667eea; font-weight: 700; margin-bottom: 15px; display: flex; align-items: center; gap: 10px;">
                            <span class="algo-badge">Dijkstra's Algorithm</span>
                            <span>Shortest Path Navigation</span>
                        </div>
                        <div class="path-nodes">
                            ${path.map((node, index) => `
                                <span class="path-node">${node}</span>
                                ${index < path.length - 1 ? '<span class="path-arrow">‚Üí</span>' : ''}
                            `).join('')}
                        </div>
                        <div style="margin-top: 15px; color: #66eaa4; font-size: 1.1rem; font-weight: 600;">
                            üìè Total Distance: <strong>${distance} units</strong>
                        </div>
                    </div>
                </div>
            `;
        }

        // Event Listeners
        document.addEventListener('DOMContentLoaded', function () {
            initializeWarehouses();

            document.getElementById('productCount').addEventListener('keypress', function (e) {
                if (e.key === 'Enter') {
                    generateProducts();
                }
            });

            document.getElementById('searchInput').addEventListener('keypress', function (e) {
                if (e.key === 'Enter') {
                    searchProduct();
                }
            });
        });
    </script>
</body>

</html>